import{m as l,Z as d,$ as p,a0 as _,O as m,v as h,a1 as S,a2 as f,a3 as M,q as R}from"./CWRP0EBR.js";function b(t,c){if(!c)return;const u=(e,a)=>{if(!t._cbs[e])return a(t.instance),()=>{};let r=t._cbs[e].push(a);const s=()=>{var n;r&&((n=t._cbs[e])==null||n.splice(r-1,1),r=null)};return f(s),s};t.onLoaded=e=>u("loaded",e),t.onError=e=>u("error",e),f(()=>{var e;(e=t._triggerAbortController)==null||e.abort()})}function w(t,c){const u=typeof t=="string"?{src:t}:t,e=c||{},a=(e==null?void 0:e.head)||p();e.head=a;const r=_();if(e.eventContext=r,r&&typeof e.trigger>"u")e.trigger=m;else if(h(e.trigger)){const n=e.trigger;let o;e.trigger=new Promise(i=>{o=S(n,g=>{g&&i(!0)},{immediate:!0}),f(()=>i(!1),!0)}).then(i=>(o==null||o(),i))}a._scriptStatusWatcher=a._scriptStatusWatcher||a.hooks.hook("script:updated",({script:n})=>{n._statusRef.value=n.status});const s=M(u,e);return s._statusRef=s._statusRef||R(s.status),b(s,r),new Proxy(s,{get(n,o,i){return Reflect.get(n,o==="status"?"_statusRef":o,i)}})}function x(t,c){const{title:u,titleTemplate:e,...a}=t;return l({title:u,titleTemplate:e,_flatMeta:a},{...c,transform(r){const s=d({...r._flatMeta});return delete r._flatMeta,{...r,meta:s}}})}export{w as a,x as u};
